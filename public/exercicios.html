<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ExercÃ­cios â€” FitApp</title>
  <link rel="stylesheet" href="./style.css">
</head>
<body class="min-h-screen pb-24 bg-zinc-950 text-white">

  <main class="p-5 max-w-md mx-auto">
    <header class="flex items-center justify-between mb-4">
      <h1 class="text-2xl font-bold">Biblioteca de ExercÃ­cios</h1>
      <input id="search" class="bg-zinc-900 rounded px-3 py-1 text-sm" placeholder="Buscar...">
    </header>

    <div id="list" class="space-y-3"></div>
  </main>

<!-- menu -->
  <nav class="fixed bottom-0 left-0 w-full bg-zinc-900 border-t border-zinc-800">
    <ul class="flex justify-around py-3 text-zinc-400">
      <li class="flex flex-col items-center">
        <a href="./index.html" class="flex flex-col items-center">
          <span class="text-xl">ğŸ </span>
          <span class="text-xs mt-1">Home</span>
        </a>
      </li>
      <li class="flex flex-col items-center">
        <a href="./treino.html" class="flex flex-col items-center text-white">
          <span class="text-xl">ğŸ”¥</span>
          <span class="text-xs mt-1">Treinos</span>
        </a>
      </li>
      <li class="flex flex-col items-center">
        <a href="./exercicios.html" class="flex flex-col items-center">
          <span class="text-xl">ğŸ’ª</span>
          <span class="text-xs mt-1">ExercÃ­cios</span>
        </a>
      </li>
      <li class="flex flex-col items-center">
        <a href="./perfil.html" class="flex flex-col items-center">
          <span class="text-xl">ğŸ‘¤</span>
          <span class="text-xs mt-1">Perfil</span>
        </a>
      </li>
    </ul>
  </nav>

  <!-- Modal de ExercÃ­cio -->
  <div id="exerciseModal" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center hidden">
    <div class="bg-zinc-900 max-w-md w-full mx-4 p-5 rounded-2xl border border-zinc-800">
      
      <h2 id="modalTitle" class="text-2xl font-bold mb-3"></h2>

      <video id="modalVideo" autoplay loop muted playsinline class="w-full rounded-xl mb-3">
        <source id="modalSource" src="" type="video/mp4">
      </video>

      <p id="modalDesc" class="text-zinc-300 text-sm leading-relaxed"></p>

      <button id="closeModal"
        class="mt-5 w-full py-2 bg-zinc-800 rounded-xl text-zinc-300 hover:bg-zinc-700 transition">
        Fechar
      </button>

    </div>
  </div>

<script type="module">
  const dataPath = './data/treinos.json';

  // NORMALIZAÃ‡ÃƒO
  function normalize(str) {
    return str
      .toLowerCase()
      .normalize("NFD")
      .replace(/[\u0300-\u036f]/g, "")
      .replace(/[^a-z0-9]/g, "");
  }

  // DADOS DOS VÃDEOS + DESCRIÃ‡Ã•ES
  const extraInfo = {
    "remadaalta": {
      video: "./videos/remada-alta.mp4",
      desc: "Excelente para trapÃ©zio, deltoides e parte superior das costas."
    },
    "elevacaofrontal": {
      video: "./videos/elevacao-frontal.mp4",
      desc: "Isola o deltoide anterior. Perfeito para arredondar os ombros."
    },
    "elevacaolateralh": {
      video: "./videos/elevacao-lateral.mp4",
      desc: "Trabalha o deltoide lateral e dÃ¡ aquela largura no shape."
    },
    "desenvolvimentoh": {
      video: "./videos/desenvolvimentoH.mp4",
      desc: "ExercÃ­cio composto completo para forÃ§a e volume dos ombros."
    },
    "sumo": {
      video: "./videos/sumo.mp4",
      desc: "Ativa glÃºteos, posterior e adutores. Excelente para quadril."
    }
  };

  async function loadExercises() {
    const res = await fetch(dataPath);
    const json = await res.json();
    const list = document.getElementById('list');
    const all = Object.values(json.treinos)
    .flatMap(t => t.exercicios)
    .sort((a, b) => a.nome.localeCompare(b.nome));


    function render(filter='') {
      list.innerHTML = '';

      const filtered = all.filter(e =>
        e.nome.toLowerCase().includes(filter.toLowerCase())
      );

      filtered.forEach(ex => {
        const div = document.createElement('div');
        div.className =
          'bg-zinc-900 p-4 rounded-xl border border-zinc-800 cursor-pointer hover:border-zinc-700 transition';

        div.innerHTML = `
          <div class="flex justify-between">
            <div>
              <div class="font-bold">${ex.nome}</div>
              <div class="text-zinc-400 text-sm">${ex.series} x ${ex.reps}</div>
            </div>
            <div class="text-zinc-400 text-sm">â–¶</div>
          </div>
        `;

        div.addEventListener('click', () => openModal(ex));
        list.appendChild(div);
      });
    }

    document.getElementById('search')
      .addEventListener('input', e => render(e.target.value));

    render();
  }

  const modal = document.getElementById("exerciseModal");
  const modalTitle = document.getElementById("modalTitle");
  const modalVideo = document.getElementById("modalVideo");
  const modalSource = document.getElementById("modalSource");
  const modalDesc = document.getElementById("modalDesc");

  function openModal(ex) {
    const key = normalize(ex.nome);
    const info = extraInfo[key];

    modalTitle.textContent = ex.nome; // nome bonito
    modalSource.src = info?.video || "";
    modalVideo.load();
    modalDesc.textContent = info?.desc || "Sem descriÃ§Ã£o disponÃ­vel.";

    modal.classList.remove("hidden");
  }

  document.getElementById("closeModal").onclick = () => {
    modal.classList.add("hidden");
    modalVideo.pause();
  };

  loadExercises();
</script>

</body>
</html>